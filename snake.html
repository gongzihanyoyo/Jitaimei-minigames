<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- ç§»åŠ¨ç«¯è§†å£é€‚é…ï¼šå®½åº¦=device-widthï¼Œç¦æ­¢ç¼©æ”¾ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç»å…¸è´ªåƒè›‡ | Jitaimeiå°æ¸¸æˆ minigames.jitaimei.top</title>
    <style>
        /* é€šç”¨æ ·å¼é‡ç½®ï¼šæ¸…é™¤å†…å¤–è¾¹è·ï¼Œç›’æ¨¡å‹ä¸ºborder-boxï¼Œç¦æ­¢è§¦æ‘¸/æ–‡æœ¬é€‰æ‹©ï¼ˆæ¸¸æˆäº¤äº’ä¼˜åŒ–ï¼‰ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            touch-action: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        /* é¡µé¢ä¸»ä½“æ ·å¼ï¼šæ¸å˜èƒŒæ™¯ï¼Œå¼¹æ€§å¸ƒå±€å±…ä¸­ï¼Œéšè—æº¢å‡ºï¼Œæ–‡å­—ç™½è‰² */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
            color: white;
        }
        /* å¤´éƒ¨å¯¼èˆªæ ï¼šé€šæ ï¼Œæ¯›ç»ç’ƒèƒŒæ™¯ï¼Œå¼¹æ€§å¸ƒå±€ä¸¤ç«¯å¯¹é½ */
        .header {
            width: 100%;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            position: relative;
            z-index: 10;
        }
        /* è¿”å›ä¸»ç«™æŒ‰é’®ï¼šæ¸å˜èƒŒæ™¯ï¼Œåœ†è§’ï¼Œé˜´å½±hoveræ•ˆæœ */
        .back-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 15px rgba(238, 90, 36, 0.4);
        }
        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(238, 90, 36, 0.6);
        }
        /* å¤´éƒ¨å³ä¾§æŒ‰é’®å®¹å™¨ï¼šå¼¹æ€§å¸ƒå±€ï¼Œé—´è·10px */
        .header-right {
            display: flex;
            gap: 10px;
        }
        /* å›¾æ ‡æŒ‰é’®ï¼ˆè®¾ç½®/å¸®åŠ©ï¼‰ï¼šåœ†å½¢ï¼ŒåŠé€èƒŒæ™¯ï¼Œhoveræ—‹è½¬+åŠ æ·±èƒŒæ™¯ */
        .icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .icon-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(15deg);
        }
        /* æ¸¸æˆä¸»å®¹å™¨ï¼šå¼¹æ€§å æ»¡å‰©ä½™é«˜åº¦ï¼Œå±…ä¸­å¯¹é½ï¼Œæœ€å¤§å®½åº¦é™åˆ¶ */
        .game-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            width: 100%;
            max-width: 1200px;
        }
        /* å¾—åˆ†æ¿ï¼šå¤§å·å­—ä½“ï¼Œæ–‡å­—é˜´å½±ï¼Œå­—é—´è· */
        .score-board {
            font-size: 24px;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-weight: bold;
            letter-spacing: 2px;
        }
        /* æ¸¸æˆç”»å¸ƒå¤–å±‚å®¹å™¨ï¼šç›¸å¯¹å®šä½ï¼Œåœ†è§’ï¼Œæº¢å‡ºéšè—ï¼Œæ·±é»‘èƒŒæ™¯ï¼Œå¤§é˜´å½± */
        .game-wrapper {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            background: #0a0a0a;
        }
        /* æ¸¸æˆç”»å¸ƒï¼šå—çº§å…ƒç´ ï¼Œæ·±é»‘èƒŒæ™¯ */
        #gameCanvas {
            display: block;
            background: #0a0a0a;
        }
        /* PCç«¯æ“ä½œæç¤ºï¼šå±…ä¸­ï¼ŒåŠé€ï¼Œè¡Œé«˜ä¼˜åŒ– */
        .controls-hint {
            margin-top: 20px;
            text-align: center;
            opacity: 0.8;
            font-size: 14px;
            line-height: 1.6;
        }
        /* æŒ‰é”®æ ·å¼ï¼šåŠé€èƒŒæ™¯ï¼Œåœ†è§’ï¼Œç­‰å®½å­—ä½“ */
        .key {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 4px;
            margin: 0 2px;
            font-family: monospace;
        }
        /* æ¨¡æ€æ¡†åŸºç¡€æ ·å¼ï¼šå›ºå®šå…¨å±ï¼ŒåŠé€é»‘èƒŒæ™¯ï¼Œæ¯›ç»ç’ƒï¼Œé»˜è®¤éšè—ï¼Œå±…ä¸­ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 100;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        /* æ¨¡æ€æ¡†æ¿€æ´»çŠ¶æ€ï¼šæ˜¾ç¤ºå¼¹æ€§å¸ƒå±€ */
        .modal.active {
            display: flex;
        }
        /* æ¨¡æ€æ¡†å†…å®¹åŒºï¼šæ¸å˜èƒŒæ™¯ï¼Œåœ†è§’ï¼Œæœ€å¤§å®½é«˜é™åˆ¶ï¼Œæ»‘å…¥åŠ¨ç”» */
        .modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 20px;
            max-width: 90%;
            width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            animation: slideIn 0.3s ease;
        }
        /* æ¨¡æ€æ¡†æ»‘å…¥åŠ¨ç”»ï¼šä»ä¸Šæ–¹50pxæ·¡å…¥ */
        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        /* æ¨¡æ€æ¡†æ ‡é¢˜ï¼šå¤§å·å­—ä½“ï¼Œå±…ä¸­ï¼ŒåŠ ç²— */
        .modal-header {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }
        /* æ¨¡æ€æ¡†å…³é—­æŒ‰é’®ï¼šç»å¯¹å®šä½ï¼Œæ— èƒŒæ™¯ï¼Œå¤§å·å­—ä½“ï¼ŒhoveråŠ æ·±ä¸é€æ˜åº¦ */
        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            opacity: 0.8;
        }
        .modal-close:hover {
            opacity: 1;
        }
        /* è®¾ç½®é¡¹å®¹å™¨ï¼šåº•éƒ¨é—´è·20px */
        .setting-item {
            margin-bottom: 20px;
        }
        /* è®¾ç½®é¡¹æ ‡ç­¾ï¼šå—çº§ï¼Œåº•éƒ¨é—´è·ï¼ŒåŠé€ */
        .setting-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            opacity: 0.9;
        }
        /* è®¾ç½®é¡¹å½“å‰å€¼ï¼šé»„è‰²ï¼ŒåŠ ç²—ï¼Œå·¦é—´è· */
        .setting-value {
            display: inline-block;
            margin-left: 10px;
            font-weight: bold;
            color: #ffd700;
        }
        /* æ»‘å—æ ·å¼é‡ç½®ï¼šè‡ªå®šä¹‰å¤–è§‚ï¼ŒåŠé€èƒŒæ™¯ */
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: rgba(255,255,255,0.3);
            outline: none;
            -webkit-appearance: none;
        }
        /* æ»‘å—æŒ‰é’®æ ·å¼ï¼šåœ†å½¢ï¼Œé»„è‰²ï¼Œé˜´å½± */
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ffd700;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        /* ä¸»æŒ‰é’®ï¼šé€šæ ï¼Œæ¸å˜èƒŒæ™¯ï¼Œåœ†è§’ï¼Œhoveræ”¾å¤§ */
        .btn-primary {
            width: 100%;
            padding: 12px;
            background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
            border: none;
            border-radius: 25px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            transition: transform 0.2s;
        }
        .btn-primary:hover {
            transform: scale(1.05);
        }
        /* å¸®åŠ©æ¨¡å—å®¹å™¨ï¼šåº•éƒ¨é—´è· */
        .help-section {
            margin-bottom: 20px;
        }
        /* å¸®åŠ©æ¨¡å—æ ‡é¢˜ï¼šé»„è‰²ï¼Œä¸­å·å­—ä½“ */
        .help-title {
            font-size: 18px;
            margin-bottom: 10px;
            color: #ffd700;
        }
        /* å¸®åŠ©æ–‡æœ¬ï¼šè¡Œé«˜ä¼˜åŒ–ï¼ŒåŠé€ */
        .help-text {
            line-height: 1.6;
            opacity: 0.9;
        }
        /* æ‰‹åŠ¿å›¾æ ‡ï¼šå¤§å·å­—ä½“ï¼Œå·¦å³é—´è· */
        .gesture-icon {
            font-size: 24px;
            margin: 0 5px;
        }
        /* æ¸¸æˆç»“æŸå¼¹çª—ï¼šç»å¯¹å®šä½è¦†ç›–ç”»å¸ƒï¼ŒåŠé€é»‘ï¼Œé»˜è®¤éšè—ï¼Œå¼¹æ€§å‚ç›´å±…ä¸­ */
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 5;
        }
        /* æ¸¸æˆç»“æŸå¼¹çª—æ¿€æ´»çŠ¶æ€ï¼šæ˜¾ç¤º */
        .game-over.active {
            display: flex;
        }
        /* æ¸¸æˆç»“æŸæ–‡å­—ï¼šçº¢è‰²ï¼Œå¤§å·ï¼Œè„‰å†²åŠ¨ç”» */
        .game-over-text {
            font-size: 36px;
            color: #ff6b6b;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            animation: pulse 1.5s infinite;
        }
        /* è„‰å†²åŠ¨ç”»ï¼šç¼©æ”¾å¾ªç¯ */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        /* æœ€ç»ˆå¾—åˆ†ï¼šä¸­å·å­—ä½“ï¼Œåº•éƒ¨é—´è· */
        .final-score {
            font-size: 20px;
            margin-bottom: 30px;
        }
        /* é‡æ–°å¼€å§‹æŒ‰é’®ï¼šæ¸å˜èƒŒæ™¯ï¼Œåœ†è§’ï¼Œé˜´å½±hoveræ•ˆæœ */
        .restart-btn {
            padding: 15px 40px;
            font-size: 18px;
            background: linear-gradient(45deg, #4facfe 0%, #00f2fe 100%);
            border: none;
            border-radius: 30px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,242,254,0.4);
        }
        .restart-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,242,254,0.6);
        }
        /* ç§»åŠ¨ç«¯é€‚é…ï¼ˆ768pxä»¥ä¸‹ï¼‰ï¼šç¼©å°å¤´éƒ¨/å¾—åˆ†æ¿/æç¤ºæ–‡å­—ï¼Œè°ƒæ•´æŒ‰é’®å†…è¾¹è· */
        @media (max-width: 768px) {
            .header {
                padding: 10px 15px;
            }
            .back-btn {
                padding: 8px 15px;
                font-size: 12px;
            }
            .score-board {
                font-size: 20px;
            }
            .controls-hint {
                font-size: 12px;
            }
        }
        /* ç§»åŠ¨ç«¯æ»‘åŠ¨æç¤ºï¼šé»˜è®¤éšè—ï¼Œç»å¯¹å®šä½åº•éƒ¨ï¼Œæ·¡å…¥æ·¡å‡ºåŠ¨ç”» */
        .swipe-hint {
            display: none;
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            animation: fadeInOut 2s infinite;
        }
        /* ç§»åŠ¨ç«¯æ˜¾ç¤ºæ»‘åŠ¨æç¤º */
        @media (max-width: 768px) {
            .swipe-hint {
                display: block;
            }
        }
        /* æ·¡å…¥æ·¡å‡ºåŠ¨ç”»ï¼šä¸é€æ˜åº¦å¾ªç¯ */
        @keyframes fadeInOut {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- å¤´éƒ¨å¯¼èˆªï¼šè¿”å›æŒ‰é’® + è®¾ç½®/å¸®åŠ©å›¾æ ‡æŒ‰é’® -->
    <div class="header">
        <a href="https://minigames.jitaimei.top" class="back-btn">â† è¿”å›ä¸»ç«™</a>
        <div class="header-right">
            <button class="icon-btn" onclick="openSettings()" title="è®¾ç½®">âš™ï¸</button>
            <button class="icon-btn" onclick="openHelp()" title="å¸®åŠ©">â“</button>
        </div>
    </div>

    <!-- æ¸¸æˆä¸»å®¹å™¨ï¼šå¾—åˆ†æ¿ + æ¸¸æˆç”»å¸ƒ + æ“ä½œæç¤º -->
    <div class="game-container">
        <!-- å¾—åˆ†æ¿ï¼šå½“å‰å¾—åˆ† + å†å²æœ€é«˜åˆ† -->
        <div class="score-board">å¾—åˆ†: <span id="score">0</span> | æœ€é«˜åˆ†: <span id="highScore">0</span></div>
        
        <!-- æ¸¸æˆç”»å¸ƒå¤–å±‚ï¼šåŒ…å«ç”»å¸ƒã€æ¸¸æˆç»“æŸå¼¹çª—ã€ç§»åŠ¨ç«¯æ»‘åŠ¨æç¤º -->
        <div class="game-wrapper" id="gameWrapper">
            <!-- æ¸¸æˆæ ¸å¿ƒç”»å¸ƒï¼šç»˜åˆ¶è›‡/é£Ÿç‰©/ç½‘æ ¼ -->
            <canvas id="gameCanvas"></canvas>
            <!-- æ¸¸æˆç»“æŸå¼¹çª—ï¼šé»˜è®¤éšè— -->
            <div class="game-over" id="gameOver">
                <div class="game-over-text">æ¸¸æˆç»“æŸ</div>
                <div class="final-score">æœ€ç»ˆå¾—åˆ†: <span id="finalScore">0</span></div>
                <button class="restart-btn" onclick="restartGame()">é‡æ–°å¼€å§‹</button>
            </div>
            <!-- ç§»åŠ¨ç«¯æ»‘åŠ¨æç¤ºï¼šé»˜è®¤éšè—ï¼Œåª’ä½“æŸ¥è¯¢æ˜¾ç¤º -->
            <div class="swipe-hint">ğŸ‘† ä¸Šä¸‹å·¦å³æ»‘åŠ¨æ§åˆ¶æ–¹å‘</div>
        </div>
        
        <!-- PCç«¯æ“ä½œæç¤ºï¼šç§»åŠ¨ç«¯éšè— -->
        <div class="controls-hint" id="pcHint">
            ä½¿ç”¨ <span class="key">â†‘</span><span class="key">â†“</span><span class="key">â†</span><span class="key">â†’</span> æ–¹å‘é”® 
            æˆ– <span class="key">W</span><span class="key">A</span><span class="key">S</span><span class="key">D</span> ç§»åŠ¨
        </div>
    </div>

    <!-- è®¾ç½®æ¨¡æ€æ¡†ï¼šæ¸¸æˆé€Ÿåº¦/ç”»å¸ƒå®½é«˜è®¾ç½® -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('settingsModal')">&times;</button>
            <div class="modal-header">âš™ï¸ æ¸¸æˆè®¾ç½®</div>
            <!-- é€Ÿåº¦è®¾ç½®é¡¹ -->
            <div class="setting-item">
                <label class="setting-label">
                    æ¸¸æˆé€Ÿåº¦ (æ¯«ç§’/æ ¼)
                    <span class="setting-value" id="speedValue">150</span>ms
                </label>
                <input type="range" id="speedRange" min="50" max="300" value="150" oninput="updateSpeed(this.value)">
                <div style="display: flex; justify-content: space-between; font-size: 12px; opacity: 0.7; margin-top: 5px;">
                    <span>å¿«</span>
                    <span>æ…¢</span>
                </div>
            </div>
            <!-- å®½åº¦è®¾ç½®é¡¹ -->
            <div class="setting-item">
                <label class="setting-label">
                    æ¸¸æˆåŒºåŸŸå®½åº¦
                    <span class="setting-value" id="widthValue">20</span>æ ¼
                </label>
                <input type="range" id="widthRange" min="10" max="100" value="20" oninput="updateWidth(this.value)">
            </div>
            <!-- é«˜åº¦è®¾ç½®é¡¹ -->
            <div class="setting-item">
                <label class="setting-label">
                    æ¸¸æˆåŒºåŸŸé«˜åº¦
                    <span class="setting-value" id="heightValue">30</span>æ ¼
                </label>
                <input type="range" id="heightRange" min="10" max="50" value="30" oninput="updateHeight(this.value)">
                <div style="font-size: 12px; opacity: 0.7; margin-top: 5px; color: #ffd700;">
                    èŒƒå›´: 10Ã—10 è‡³ 100Ã—50 (æ›´æ”¹åéœ€é‡æ–°å¼€å§‹)
                </div>
            </div>
            <button class="btn-primary" onclick="applySettings()">åº”ç”¨å¹¶é‡æ–°å¼€å§‹</button>
        </div>
    </div>

    <!-- å¸®åŠ©æ¨¡æ€æ¡†ï¼šPC/ç§»åŠ¨ç«¯æ“ä½œè¯´æ˜ + æ¸¸æˆè§„åˆ™ -->
    <div class="modal" id="helpModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('helpModal')">&times;</button>
            <div class="modal-header">â“ æ¸¸æˆå¸®åŠ©</div>
            <!-- PCç«¯æ“ä½œ -->
            <div class="help-section">
                <div class="help-title">ğŸ–¥ï¸ ç”µè„‘ç«¯æ“ä½œ</div>
                <div class="help-text">
                    ä½¿ç”¨é”®ç›˜æ–¹å‘é”® <span class="key">â†‘</span><span class="key">â†“</span><span class="key">â†</span><span class="key">â†’</span> 
                    æˆ– WASD é”® <span class="key">W</span><span class="key">A</span><span class="key">S</span><span class="key">D</span> 
                    æ§åˆ¶è›‡çš„ç§»åŠ¨æ–¹å‘ã€‚
                </div>
            </div>
            <!-- ç§»åŠ¨ç«¯æ“ä½œ -->
            <div class="help-section">
                <div class="help-title">ğŸ“± ç§»åŠ¨ç«¯æ“ä½œ</div>
                <div class="help-text">
                    åœ¨æ¸¸æˆåŒºåŸŸä¸Š<span class="gesture-icon">ğŸ‘†</span>ä¸Šä¸‹å·¦å³æ»‘åŠ¨æ¥æ§åˆ¶ç§»åŠ¨æ–¹å‘ã€‚
                    æ”¯æŒå¿«é€Ÿæ»‘åŠ¨å’Œæ…¢é€Ÿæ»‘åŠ¨ã€‚
                </div>
            </div>
            <!-- æ¸¸æˆè§„åˆ™ -->
            <div class="help-section">
                <div class="help-title">ğŸ¯ æ¸¸æˆè§„åˆ™</div>
                <div class="help-text">
                    æ§åˆ¶è›‡åƒæ‰çº¢è‰²çš„é£Ÿç‰©æ¥å¢é•¿èº«ä½“å’Œå¾—åˆ†ã€‚ä¸è¦æ’å¢™æˆ–æ’åˆ°è‡ªå·±ï¼
                    é€Ÿåº¦è¶Šå¿«ï¼ŒæŒ‘æˆ˜è¶Šå¤§ã€‚
                </div>
            </div>
            <button class="btn-primary" onclick="closeModal('helpModal')">çŸ¥é“äº†</button>
        </div>
    </div>

    <script>
        // æ¸¸æˆæ ¸å¿ƒé…ç½®å¯¹è±¡ï¼šå•å…ƒæ ¼å¤§å°ã€ç”»å¸ƒç½‘æ ¼å®½é«˜ã€æ¸¸æˆé€Ÿåº¦ã€é¢œè‰²ä¸»é¢˜
        const config = {
            cellSize: 20,    // æ¯ä¸ªç½‘æ ¼å•å…ƒæ ¼çš„åƒç´ å¤§å°
            gridWidth: 20,   // æ¸¸æˆåŒºåŸŸç½‘æ ¼å®½åº¦ï¼ˆåˆ—æ•°ï¼‰
            gridHeight: 30,  // æ¸¸æˆåŒºåŸŸç½‘æ ¼é«˜åº¦ï¼ˆè¡Œæ•°ï¼‰
            speed: 150,      // æ¸¸æˆé€Ÿåº¦ï¼šæ¯«ç§’/æ ¼ï¼ˆå€¼è¶Šå°è¶Šå¿«ï¼‰
            colors: {        // é¢œè‰²é…ç½®ï¼šè›‡èº«/è›‡å¤´/é£Ÿç‰©/ç½‘æ ¼
                snake: '#4facfe',
                snakeHead: '#00f2fe',
                food: '#ff6b6b',
                grid: '#1a1a1a'
            }
        };

        // æ¸¸æˆå…¨å±€çŠ¶æ€å˜é‡
        let snake = [];        // è›‡çš„èº«ä½“æ•°ç»„ï¼šæ¯ä¸ªå…ƒç´ ä¸º{x,y}åæ ‡
        let food = {};         // é£Ÿç‰©åæ ‡{x,y}
        let direction = 'right';// è›‡å½“å‰ç§»åŠ¨æ–¹å‘
        let nextDirection = 'right';// è›‡ä¸‹ä¸€æ¬¡ç§»åŠ¨æ–¹å‘ï¼ˆè§£å†³è¿ç»­æŒ‰é”®å†²çªï¼‰
        let score = 0;         // å½“å‰å¾—åˆ†
        let highScore = localStorage.getItem('snakeHighScore') || 0; // å†å²æœ€é«˜åˆ†ï¼ˆæœ¬åœ°å­˜å‚¨ï¼‰
        let gameLoop = null;   // æ¸¸æˆä¸»å¾ªç¯å®šæ—¶å™¨
        let isGameOver = false;// æ¸¸æˆæ˜¯å¦ç»“æŸ
        let isPaused = false;  // æ¸¸æˆæ˜¯å¦æš‚åœï¼ˆæ‰“å¼€æ¨¡æ€æ¡†æ—¶æš‚åœï¼‰
        let touchStartX = 0;   // ç§»åŠ¨ç«¯è§¦æ‘¸èµ·å§‹Xåæ ‡
        let touchStartY = 0;   // ç§»åŠ¨ç«¯è§¦æ‘¸èµ·å§‹Yåæ ‡

        // è·å–ç”»å¸ƒå…ƒç´ å’Œ2Dç»˜å›¾ä¸Šä¸‹æ–‡
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const wrapper = document.getElementById('gameWrapper');
        // åˆ¤æ–­æ˜¯å¦ä¸ºç§»åŠ¨ç«¯ï¼šå±å¹•å®½åº¦â‰¤768 æˆ– æ”¯æŒè§¦æ‘¸äº‹ä»¶
        const isMobile = window.innerWidth <= 768 || 'ontouchstart' in window;

        // è®¾å¤‡å·®å¼‚åŒ–é…ç½®ï¼šPCç«¯åŠ å®½æ¸¸æˆåŒºåŸŸï¼Œç§»åŠ¨ç«¯éšè—PCæ“ä½œæç¤º
        if (!isMobile) {
            config.gridWidth = 50;
            config.gridHeight = 30;
            document.getElementById('widthRange').value = 50;
            document.getElementById('widthValue').textContent = 50;
        } else {
            document.getElementById('pcHint').style.display = 'none';
        }
        // åˆå§‹åŒ–é¡µé¢æ˜¾ç¤ºæœ€é«˜åˆ†
        document.getElementById('highScore').textContent = highScore;

        /**
         * æ¸¸æˆåˆå§‹åŒ–ï¼šç”»å¸ƒè‡ªé€‚åº” + é‡ç½®æ¸¸æˆçŠ¶æ€ + å¯åŠ¨æ¸¸æˆå¾ªç¯
         */
        function initGame() {
            resizeCanvas();
            resetGame();
            startGame();
        }

        /**
         * ç”»å¸ƒè‡ªé€‚åº”ï¼šæ ¹æ®å±å¹•å¤§å°ç¼©æ”¾ç”»å¸ƒï¼Œä¿è¯å®Œæ•´æ˜¾ç¤ºä¸”ä¸è¶…å‡ºå±å¹•
         */
        function resizeCanvas() {
            // è®¾ç½®ç”»å¸ƒå®é™…åƒç´ å°ºå¯¸ï¼ˆç½‘æ ¼æ•°*å•å…ƒæ ¼å¤§å°ï¼‰
            canvas.width = config.gridWidth * config.cellSize;
            canvas.height = config.gridHeight * config.cellSize;
            // è®¡ç®—å±å¹•å¯ç”¨æœ€å¤§å®½é«˜
            const maxWidth = window.innerWidth - 40;
            const maxHeight = window.innerHeight - 200;
            // è®¡ç®—ç¼©æ”¾æ¯”ä¾‹ï¼šå–å®½/é«˜ç¼©æ”¾çš„æœ€å°å€¼ï¼Œæœ€å¤§ä¸º1ï¼ˆä¸æ”¾å¤§ï¼‰
            const scale = Math.min(
                maxWidth / canvas.width,
                maxHeight / canvas.height,
                1
            );
            // åº”ç”¨ç¼©æ”¾æ¯”ä¾‹åˆ°ç”»å¸ƒæ ·å¼
            if (scale < 1) {
                canvas.style.width = (canvas.width * scale) + 'px';
                canvas.style.height = (canvas.height * scale) + 'px';
            } else {
                canvas.style.width = canvas.width + 'px';
                canvas.style.height = canvas.height + 'px';
            }
        }

        /**
         * é‡ç½®æ¸¸æˆçŠ¶æ€ï¼šåˆå§‹åŒ–è›‡çš„ä½ç½®ã€æ–¹å‘ã€å¾—åˆ†ï¼Œç”Ÿæˆé£Ÿç‰©ï¼Œéšè—æ¸¸æˆç»“æŸå¼¹çª—
         */
        function resetGame() {
            // è›‡çš„åˆå§‹ä½ç½®ï¼šç”»å¸ƒä¸­å¿ƒï¼Œ3èŠ‚èº«ä½“
            const startX = Math.floor(config.gridWidth / 2);
            const startY = Math.floor(config.gridHeight / 2);
            snake = [
                {x: startX, y: startY},
                {x: startX - 1, y: startY},
                {x: startX - 2, y: startY}
            ];
            direction = 'right';
            nextDirection = 'right';
            score = 0;
            isGameOver = false;
            isPaused = false;
            // æ›´æ–°é¡µé¢å¾—åˆ†æ˜¾ç¤º
            document.getElementById('score').textContent = score;
            // éšè—æ¸¸æˆç»“æŸå¼¹çª—
            document.getElementById('gameOver').classList.remove('active');
            // ç”Ÿæˆåˆå§‹é£Ÿç‰©
            generateFood();
        }

        /**
         * ç”Ÿæˆé£Ÿç‰©ï¼šéšæœºåæ ‡ï¼Œç¡®ä¿ä¸ç”Ÿæˆåœ¨è›‡çš„èº«ä½“ä¸Š
         */
        function generateFood() {
            do {
                // éšæœºç”Ÿæˆç½‘æ ¼å†…çš„åæ ‡
                food = {
                    x: Math.floor(Math.random() * config.gridWidth),
                    y: Math.floor(Math.random() * config.gridHeight)
                };
                // å¾ªç¯ç›´åˆ°é£Ÿç‰©åæ ‡ä¸åœ¨è›‡èº«ä¸Š
            } while (isSnakeAt(food.x, food.y));
        }

        /**
         * åˆ¤æ–­æŒ‡å®šåæ ‡æ˜¯å¦åœ¨è›‡çš„èº«ä½“ä¸Š
         * @param {number} x - ç½‘æ ¼Xåæ ‡
         * @param {number} y - ç½‘æ ¼Yåæ ‡
         * @returns {boolean} å­˜åœ¨è¿”å›trueï¼Œå¦åˆ™false
         */
        function isSnakeAt(x, y) {
            return snake.some(segment => segment.x === x && segment.y === y);
        }

        /**
         * æ¸¸æˆä¸»å¾ªç¯æ­¥éª¤ï¼šç§»åŠ¨è›‡ã€ç¢°æ’æ£€æµ‹ã€åƒé£Ÿç‰©åˆ¤æ–­ã€é‡ç»˜ç”»å¸ƒ
         */
        function gameStep() {
            // æ¸¸æˆç»“æŸ/æš‚åœæ—¶ç›´æ¥è¿”å›
            if (isGameOver || isPaused) return;
            // æ›´æ–°å½“å‰æ–¹å‘ä¸ºä¸‹ä¸€æ¬¡æ–¹å‘ï¼ˆè§£å†³è¿ç»­æŒ‰é”®å†²çªï¼‰
            direction = nextDirection;

            // å¤åˆ¶è›‡å¤´åæ ‡ï¼Œè®¡ç®—æ–°çš„è›‡å¤´ä½ç½®
            const head = {...snake[0]};
            switch(direction) {
                case 'up': head.y--; break;
                case 'down': head.y++; break;
                case 'left': head.x--; break;
                case 'right': head.x++; break;
            }

            // ç¢°æ’æ£€æµ‹1ï¼šæ’å¢™ï¼ˆè¶…å‡ºç½‘æ ¼è¾¹ç•Œï¼‰
            if (head.x < 0 || head.x >= config.gridWidth || 
                head.y < 0 || head.y >= config.gridHeight) {
                gameOver();
                return;
            }
            // ç¢°æ’æ£€æµ‹2ï¼šæ’è‡ªå·±ï¼ˆæ–°è›‡å¤´åœ¨èº«ä½“ä¸Šï¼‰
            if (isSnakeAt(head.x, head.y)) {
                gameOver();
                return;
            }

            // ç§»åŠ¨è›‡ï¼šæ–°è›‡å¤´åŠ å…¥æ•°ç»„å¤´éƒ¨
            snake.unshift(head);
            // åƒé£Ÿç‰©åˆ¤æ–­ï¼šæ–°è›‡å¤´ä¸é£Ÿç‰©åæ ‡é‡åˆ
            if (head.x === food.x && head.y === food.y) {
                // å¾—åˆ†+10ï¼Œæ›´æ–°é¡µé¢æ˜¾ç¤º
                score += 10;
                document.getElementById('score').textContent = score;
                // æ›´æ–°æœ€é«˜åˆ†ï¼šæœ¬åœ°å­˜å‚¨+é¡µé¢æ˜¾ç¤º
                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('snakeHighScore', highScore);
                    document.getElementById('highScore').textContent = highScore;
                }
                // ç”Ÿæˆæ–°é£Ÿç‰©ï¼ˆè›‡èº«å¢é•¿ï¼Œä¸åˆ é™¤å°¾éƒ¨ï¼‰
                generateFood();
            } else {
                // æ²¡åƒé£Ÿç‰©ï¼šåˆ é™¤è›‡å°¾ï¼Œä¿æŒèº«ä½“é•¿åº¦ä¸å˜
                snake.pop();
            }

            // é‡ç»˜ç”»å¸ƒ
            draw();
        }

        /**
         * ç»˜åˆ¶æ¸¸æˆç”»é¢ï¼šç½‘æ ¼ â†’ é£Ÿç‰© â†’ è›‡ï¼ˆè›‡å¤´å¸¦çœ¼ç›ï¼‰
         */
        function draw() {
            // 1. ç»˜åˆ¶ç½‘æ ¼èƒŒæ™¯
            ctx.fillStyle = config.colors.grid;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            // ç»˜åˆ¶ç½‘æ ¼çº¿ï¼šæµ…ç°è‰²ç»†çº¿æ¡
            ctx.strokeStyle = '#222';
            ctx.lineWidth = 0.5;
            // ç«–çº¿
            for (let i = 0; i <= config.gridWidth; i++) {
                ctx.beginPath();
                ctx.moveTo(i * config.cellSize, 0);
                ctx.lineTo(i * config.cellSize, canvas.height);
                ctx.stroke();
            }
            // æ¨ªçº¿
            for (let i = 0; i <= config.gridHeight; i++) {
                ctx.beginPath();
                ctx.moveTo(0, i * config.cellSize);
                ctx.lineTo(canvas.width, i * config.cellSize);
                ctx.stroke();
            }

            // 2. ç»˜åˆ¶é£Ÿç‰©ï¼šåœ†å½¢ï¼Œå¸¦å‘å…‰é˜´å½±
            ctx.shadowBlur = 15;
            ctx.shadowColor = config.colors.food;
            ctx.fillStyle = config.colors.food;
            ctx.beginPath();
            ctx.arc(
                food.x * config.cellSize + config.cellSize/2, // åœ†å¿ƒX
                food.y * config.cellSize + config.cellSize/2, // åœ†å¿ƒY
                config.cellSize/2 - 2, // åŠå¾„ï¼ˆç•™è¾¹è·ï¼‰
                0,
                Math.PI * 2 // æ•´åœ†
            );
            ctx.fill();
            ctx.shadowBlur = 0; // å…³é—­é˜´å½±ï¼Œé¿å…å½±å“åç»­ç»˜åˆ¶

            // 3. ç»˜åˆ¶è›‡ï¼šè›‡å¤´ç‰¹æ®Šé¢œè‰²+å‘å…‰+çœ¼ç›ï¼Œè›‡èº«æ™®é€šé¢œè‰²
            snake.forEach((segment, index) => {
                if (index === 0) {
                    // è›‡å¤´æ ·å¼
                    ctx.fillStyle = config.colors.snakeHead;
                    ctx.shadowBlur = 10;
                    ctx.shadowColor = config.colors.snakeHead;
                } else {
                    // è›‡èº«æ ·å¼
                    ctx.fillStyle = config.colors.snake;
                    ctx.shadowBlur = 0;
                }
                // ç»˜åˆ¶è›‡çš„å•å…ƒæ ¼ï¼ˆç•™1pxè¾¹è·ï¼‰
                ctx.fillRect(
                    segment.x * config.cellSize + 1,
                    segment.y * config.cellSize + 1,
                    config.cellSize - 2,
                    config.cellSize - 2
                );

                // ç»˜åˆ¶è›‡å¤´çœ¼ç›ï¼šæ ¹æ®ç§»åŠ¨æ–¹å‘è°ƒæ•´çœ¼ç›ä½ç½®
                if (index === 0) {
                    ctx.fillStyle = '#fff'; // çœ¼ç›ç™½è‰²
                    const eyeSize = 3;      // çœ¼ç›å¤§å°
                    const offset = 5;       // çœ¼ç›åç§»é‡
                    if (direction === 'up' || direction === 'down') {
                        // ä¸Šä¸‹æ–¹å‘ï¼šçœ¼ç›å·¦å³åˆ†å¸ƒ
                        ctx.fillRect(segment.x * config.cellSize + offset, segment.y * config.cellSize + (direction === 'up' ? offset : config.cellSize - offset - eyeSize), eyeSize, eyeSize);
                        ctx.fillRect(segment.x * config.cellSize + config.cellSize - offset - eyeSize, segment.y * config.cellSize + (direction === 'up' ? offset : config.cellSize - offset - eyeSize), eyeSize, eyeSize);
                    } else {
                        // å·¦å³æ–¹å‘ï¼šçœ¼ç›ä¸Šä¸‹åˆ†å¸ƒ
                        ctx.fillRect(segment.x * config.cellSize + (direction === 'left' ? offset : config.cellSize - offset - eyeSize), segment.y * config.cellSize + offset, eyeSize, eyeSize);
                        ctx.fillRect(segment.x * config.cellSize + (direction === 'left' ? offset : config.cellSize - offset - eyeSize), segment.y * config.cellSize + config.cellSize - offset - eyeSize, eyeSize, eyeSize);
                    }
                }
            });
            ctx.shadowBlur = 0; // ç¡®ä¿é˜´å½±å…³é—­
        }

        /**
         * æ¸¸æˆç»“æŸå¤„ç†ï¼šæ¸…é™¤å®šæ—¶å™¨ï¼Œæ˜¾ç¤ºç»“æŸå¼¹çª—ï¼Œæ›´æ–°æœ€ç»ˆå¾—åˆ†
         */
        function gameOver() {
            isGameOver = true;
            clearInterval(gameLoop);
            document.getElementById('finalScore').textContent = score;
            document.getElementById('gameOver').classList.add('active');
        }

        /**
         * å¯åŠ¨æ¸¸æˆå¾ªç¯ï¼šè®¾ç½®å®šæ—¶å™¨ï¼Œæ¯éš”config.speedæ‰§è¡Œä¸€æ¬¡gameStep
         */
        function startGame() {
            // å…ˆæ¸…é™¤åŸæœ‰å®šæ—¶å™¨ï¼Œé¿å…é‡å¤å¯åŠ¨
            if (gameLoop) clearInterval(gameLoop);
            gameLoop = setInterval(gameStep, config.speed);
        }

        /**
         * é‡æ–°å¼€å§‹æ¸¸æˆï¼šé‡ç½®çŠ¶æ€ + å¯åŠ¨å¾ªç¯
         */
        function restartGame() {
            resetGame();
            startGame();
        }

        // PCç«¯é”®ç›˜äº‹ä»¶ï¼šæ§åˆ¶è›‡çš„ç§»åŠ¨æ–¹å‘ï¼Œç¦æ­¢åå‘ç§»åŠ¨ï¼ˆå¦‚å‘å³æ—¶ä¸èƒ½ç›´æ¥å‘å·¦ï¼‰
        document.addEventListener('keydown', (e) => {
            if (isGameOver) return;
            const key = e.key.toLowerCase();
            if ((key === 'arrowup' || key === 'w') && direction !== 'down') {
                nextDirection = 'up';
                e.preventDefault(); // é˜»æ­¢é»˜è®¤æ»šåŠ¨è¡Œä¸º
            } else if ((key === 'arrowdown' || key === 's') && direction !== 'up') {
                nextDirection = 'down';
                e.preventDefault();
            } else if ((key === 'arrowleft' || key === 'a') && direction !== 'right') {
                nextDirection = 'left';
                e.preventDefault();
            } else if ((key === 'arrowright' || key === 'd') && direction !== 'left') {
                nextDirection = 'right';
                e.preventDefault();
            }
        });

        // ç§»åŠ¨ç«¯è§¦æ‘¸å¼€å§‹äº‹ä»¶ï¼šè®°å½•è§¦æ‘¸èµ·å§‹åæ ‡
        canvas.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
            e.preventDefault();
        }, {passive: false});

        // ç§»åŠ¨ç«¯è§¦æ‘¸ç§»åŠ¨äº‹ä»¶ï¼šé˜»æ­¢é»˜è®¤æ»šåŠ¨è¡Œä¸º
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
        }, {passive: false});

        // ç§»åŠ¨ç«¯è§¦æ‘¸ç»“æŸäº‹ä»¶ï¼šåˆ¤æ–­æ»‘åŠ¨æ–¹å‘ï¼Œæ§åˆ¶è›‡çš„ç§»åŠ¨ï¼Œç¦æ­¢åå‘
        canvas.addEventListener('touchend', (e) => {
            if (isGameOver) return;
            // è·å–è§¦æ‘¸ç»“æŸåæ ‡
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;
            // è®¡ç®—æ»‘åŠ¨åç§»é‡
            const dx = touchEndX - touchStartX;
            const dy = touchEndY - touchStartY;
            const minSwipeDistance = 30; // æœ€å°æ»‘åŠ¨è·ç¦»ï¼ˆè¿‡æ»¤è¯¯è§¦ï¼‰

            // æ°´å¹³æ»‘åŠ¨ï¼ˆXåç§»é‡æ›´å¤§ä¸”è¶…è¿‡æœ€å°è·ç¦»ï¼‰
            if (Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > minSwipeDistance) {
                if (dx > 0 && direction !== 'left') nextDirection = 'right';
                else if (dx < 0 && direction !== 'right') nextDirection = 'left';
            }
            // å‚ç›´æ»‘åŠ¨ï¼ˆYåç§»é‡æ›´å¤§ä¸”è¶…è¿‡æœ€å°è·ç¦»ï¼‰
            else if (Math.abs(dy) > minSwipeDistance) {
                if (dy > 0 && direction !== 'up') nextDirection = 'down';
                else if (dy < 0 && direction !== 'down') nextDirection = 'up';
            }
            e.preventDefault();
        }, {passive: false});

        // é¡µé¢è§¦æ‘¸ç§»åŠ¨ï¼šå…¨å±€é˜»æ­¢é»˜è®¤æ»šåŠ¨ï¼Œé¿å…æ¸¸æˆæ—¶å±å¹•æ»‘åŠ¨
        document.body.addEventListener('touchmove', (e) => {
            e.preventDefault();
        }, {passive: false});

        /**
         * æ‰“å¼€è®¾ç½®æ¨¡æ€æ¡†ï¼šæ¿€æ´»æ˜¾ç¤ºï¼Œæš‚åœæ¸¸æˆ
         */
        function openSettings() {
            document.getElementById('settingsModal').classList.add('active');
            isPaused = true;
        }

        /**
         * æ‰“å¼€å¸®åŠ©æ¨¡æ€æ¡†ï¼šæ¿€æ´»æ˜¾ç¤ºï¼Œæš‚åœæ¸¸æˆ
         */
        function openHelp() {
            document.getElementById('helpModal').classList.add('active');
            isPaused = true;
        }

        /**
         * å…³é—­æ¨¡æ€æ¡†ï¼šéšè—ï¼Œæ¢å¤æ¸¸æˆ
         * @param {string} modalId - æ¨¡æ€æ¡†ID
         */
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            isPaused = false;
        }

        /**
         * æ›´æ–°æ¸¸æˆé€Ÿåº¦ï¼šåŒæ­¥æ»‘å—å€¼åˆ°é…ç½®å’Œé¡µé¢æ˜¾ç¤º
         * @param {number} value - æ»‘å—å½“å‰å€¼
         */
        function updateSpeed(value) {
            document.getElementById('speedValue').textContent = value;
            config.speed = parseInt(value);
        }

        /**
         * æ›´æ–°å®½åº¦æ˜¾ç¤ºï¼šåŒæ­¥æ»‘å—å€¼åˆ°é¡µé¢ï¼ˆåº”ç”¨æ—¶æ‰æ›´æ–°é…ç½®ï¼‰
         * @param {number} value - æ»‘å—å½“å‰å€¼
         */
        function updateWidth(value) {
            document.getElementById('widthValue').textContent = value;
        }

        /**
         * æ›´æ–°é«˜åº¦æ˜¾ç¤ºï¼šåŒæ­¥æ»‘å—å€¼åˆ°é¡µé¢ï¼ˆåº”ç”¨æ—¶æ‰æ›´æ–°é…ç½®ï¼‰
         * @param {number} value - æ»‘å—å½“å‰å€¼
         */
        function updateHeight(value) {
            document.getElementById('heightValue').textContent = value;
        }

        /**
         * åº”ç”¨æ¸¸æˆè®¾ç½®ï¼šæ›´æ–°é…ç½®ï¼Œå…³é—­æ¨¡æ€æ¡†ï¼Œé‡æ–°åˆå§‹åŒ–æ¸¸æˆ
         */
        function applySettings() {
            config.gridWidth = parseInt(document.getElementById('widthRange').value);
            config.gridHeight = parseInt(document.getElementById('heightRange').value);
            config.speed = parseInt(document.getElementById('speedRange').value);
            closeModal('settingsModal');
            initGame();
        }

        // çª—å£å¤§å°æ”¹å˜äº‹ä»¶ï¼šé‡æ–°é€‚é…ç”»å¸ƒå¹¶ç»˜åˆ¶
        window.addEventListener('resize', () => {
            resizeCanvas();
            draw();
        });

        // é¡µé¢åŠ è½½å®Œæˆï¼Œåˆå§‹åŒ–å¹¶å¯åŠ¨æ¸¸æˆ
        initGame();
    </script>
</body>
</html>